{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/products.js","webpack:///./js/products.store.js","webpack:///./js/products.vue.js","webpack:///./node_modules/image-gallery-overlay/build/js/CSSEditableProps.js","webpack:///./node_modules/image-gallery-overlay/build/js/CSSTemplate.js","webpack:///./node_modules/image-gallery-overlay/build/js/HTMLTemplate.js","webpack:///./node_modules/image-gallery-overlay/build/js/carousel.js"],"names":["carousel","JSON_FILE_NAME","PRODUCTS_URL","productsJsonUrl","prodStore","WSIProdStore","prodVM","WSIProductsVM","fileName","pathMinusFile","location","pathname","substring","lastIndexOf","protocol","hostname","port","handleProductClick","evt","isProductImage","el","tagName","dataset","id","target","thisProduct","getProduct","imgHrefs","images","map","image","href","populate","name","then","show","addProdStoreToVM","productIds","forEach","addProduct","getVueProduct","mapEnterKeysToClickEvent","cardsParent","addEventListener","e","elem","key","click","addImageClickListener","addOverlayHideListener","$","on","addEscapeKeyListener","document","is","activeElement","blur","addEventListeners","getElementById","pageInit","readProducts","result","catch","err","alert","initPageOnWindowLoad","window","OverlayCarousel","thumbnailHoverOutline","url","products","jsonURL","groupsToObject","obj","group","fetchJSON","fileURL","fetchOptions","method","fetch","response","json","console","error","rawData","groups","reduce","Object","keys","productId","product","undefined","vueProduct","heroHref","hero","priceRange","price","vmID","priceLabel","regularPrice","salePrice","notOnSale","currencySymbol","Vue","component","props","template","data","methods","push","length","displayPrice","regular","selling","isOnSale","reg","sale","low","high","priceString","CSSEditableProps","fontFamily","headerPadding","headerParagraphMargin","footerPadding","thumbnailBtnPadding","thumbnailBtnMargin","thumbnailImgHeight","thumbnailImgHoverFilter","thumbnailBorder","thumbnailSelectedOpacity","thumbnailSelectedFilter","CSSTemplate","HTMLTemplate","userEditsToCSSProps","editableCSSProps","cssContent","slice","htmlRefs","_modalIsShowing","_initOverlayState","inTransition","imgSrc","imgAlt","imgTitle","imgIndex","timeoutID","_overlayState","_initThumbnailsState","imgs","firstThumbnailImg","firstThumbnailBtn","lastThumbnailImg","lastTumbnailBtn","selectedThumbnailImg","_thumbnailsState","_hasSmoothScrolling","getComputedStyle","scrollBehavior","_applyUserEditsToCSSProps","edits","entries","propName","value","_applyCSSPropsToCSSContent","searchStr","subStr","replace","_createStyleSheetElement","textContent","style","createElement","_createCarouselModalContainer","innerHTML","div","_htmlElementReferences","galleryOverlay","shadowRoot","cModalContainer","cModal","querySelector","cmBackdrop","cmDialog","cmContent","cmHeader","cmHeaderP","closeBtn","cmBody","carouselContainer","heroImg","overlayDiv","overlayImg","cmFooter","thumbnailsDiv","GalleryOverlay","attachShadow","mode","append","HTMLElement","_createGalleryOverlay","customElements","define","_appendGalleryOverlayToBody","body","appendChild","_selectAndDisplayImage","thumbnailImg","animate","classList","remove","add","_scrollThumbnailsViewport","clearTimeout","assign","src","alt","title","Number","index","_completeImageFade","thisIndex","setTimeout","_listenForEnterKeyOverButton","handleEnterKey","btnImg","firstChild","_listenForThumbnailImageClicks","handleClick","elClicked","isThumbnailImg","_listenForImageOverlayFade","_handleTab","isShiftTab","shiftKey","elWithFocus","lastThumbnailHasFocus","lastThumbnailBtn","tabbingFromLastThumbnail","closeBtnHasFocus","shiftTabbingFromCloseBtn","preventDefault","focus","_listenForTabKey","_removeTabKeyListener","removeEventListener","_hideModal","display","once","_listenForHideModalEvents","_vpScrollJavaScript","scrollDest","timeStep","timeTotal","stepsTotal","Math","round","scrollStart","scrollLeft","scrollTotal","scrollStep","time","scroll","_scrollRecursive","vpScrollWidth","scrollWidth","vpStyle","vpPaddingLeft","parseFloat","paddingLeft","vpWindowWidth","clientWidth","vpScrollMax","tnButton","parentElement","tnButtonStyle","tnButtonWidth","offsetWidth","marginLeft","marginRight","tnOffsetCenter","offsetLeft","newScrollLeft","_populateThumbnails","hrefs","titles","imgOnLoadHandler","btnThumb","imgThumb","onload","String","hasMultipleImages","hrefsCount","completed","Promise","resolve","reject","displaySave","imagesLoaded","aspectRatioMin","Infinity","_evalLoadedImage","img","imgAspectRatio","height","width","aspectRatio","paddingBottom","modalAspectRatio","offsetHeight","maxWidth","errmsg","_init"],"mappings":"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","file":"products.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./js/products.js\");\n","// products page for Karthik Coding Challenge  Williams Sonoma \nimport WSIProdStore from './products.store.js';\nimport WSIProductsVM from './products.vue.js';\nimport OverlayCarousel from\n    '../node_modules/image-gallery-overlay/build/js/carousel.js';\nlet carousel;\n\nconst JSON_FILE_NAME = 'wsi-products.json';\nconst PRODUCTS_URL = productsJsonUrl(JSON_FILE_NAME);\nconst prodStore = new WSIProdStore(PRODUCTS_URL);\nconst prodVM = WSIProductsVM('productsvm');\n\n// forn the URL to the products json file\n// assumption: json file is stored in same path as web page\nfunction productsJsonUrl (fileName) {\n  const pathMinusFile = location.pathname.substring(0,\n    location.pathname.lastIndexOf('/'));\n  return `${location.protocol}//${location.hostname}:${location.port}` +\n    `${pathMinusFile}/${fileName}`;\n}\n\n// display overlay carousel when product image is clicked\nfunction handleProductClick (evt) {\n  const isProductImage = (el) =>\n    el.tagName === 'IMG' && typeof el.dataset.id !== 'undefined';\n  const target = evt.target;\n  if (isProductImage(target) === false) {\n    return;\n  }\n  const thisProduct = prodStore.getProduct(target.dataset.id);\n  const imgHrefs = thisProduct.images.map((image) => image.href);\n  carousel.populate(thisProduct.name, imgHrefs)\n    .then(() => {\n      carousel.show();\n    });\n}\n\n// add all products in prodstore to Vue model\nfunction addProdStoreToVM () {\n  prodStore.productIds().forEach((id) => {\n    prodVM.addProduct(prodStore.getVueProduct(id));\n  });\n}\n\n// accessibility: listen for 'enter' key events on images and convert\n// to click\nfunction mapEnterKeysToClickEvent (cardsParent) {\n  cardsParent.addEventListener('keydown', (e) => {\n    const elem = e.target;\n    if (e.key === 'Enter' && elem.tagName === 'IMG') {\n      elem.click();\n    }\n  });\n}\n\n// in order to detect a click on any one of the card images\n// add one event listener to the parent of the product cards\nfunction addImageClickListener (cardsParent) {\n  cardsParent.addEventListener('click', handleProductClick);\n}\n\n// respond to hiding of overlay modal\nfunction addOverlayHideListener () {\n  $('#carouselModal').on('hidden.bs.modal', () => {\n    // no cleanup needed\n  });\n}\n\n// listen for escape key, then de-focus an active image\nfunction addEscapeKeyListener () {\n  document.addEventListener('keydown', (evt) => {\n    if (evt.key !== 'Escape') { return; }\n    if ($('#carouselModal').is(':visible')) { return; }\n    if (document.activeElement) {\n      document.activeElement.blur();\n    }\n  });\n}\n\n// add all of our event listeners\nfunction addEventListeners () {\n  const cardsParent = document.getElementById('products-container');\n  addImageClickListener(cardsParent);\n  mapEnterKeysToClickEvent(cardsParent);\n  addOverlayHideListener();\n  addEscapeKeyListener();\n}\n\n// initialize the page\nfunction pageInit () {\n\n  addEventListeners();\n\n  // read in products and add to Vue model\n  prodStore.readProducts()\n    .then(result => {\n      if (result !== true) {\n        throw 'unable to read products';\n      }\n      addProdStoreToVM();\n    })\n    .catch(err => alert(err)); // TODO replace alert with modal dialog\n}\n\nfunction initPageOnWindowLoad () {\n  window.addEventListener('load', () => {\n    // install the overlay carousel\n    carousel = new OverlayCarousel({\n      thumbnailHoverOutline: '2px solid dodgerblue'\n    });\n\n    pageInit();\n  });\n}\n\ninitPageOnWindowLoad();\n\nexport default pageInit;\n","/**\n * products store for Karthik Coding Challenge  Williams Sonoma \n * @param url\n * @return {{readProducts: (function(): Promise<boolean>), getVueProduct: (function(*): {heroHref: *, name: *, id: *}), getProduct: (function(*): *), productIds: (function(): string[])}}\n * @constructor\n */\nfunction WSIProdStore (url) {\n\n  let products;\n  let jsonURL = url;\n\n  // to enable effient access to a product by id,\n  // reduce `productsRaw.groups` array\n  // to object with property names of `id`\n  const groupsToObject = (obj, group) => {\n    obj[group.id] = group;\n    return obj;\n  };\n\n  // fetch a JSON file and convert to object\n  function fetchJSON (fileURL) {\n    // console.log(`fetchJSON(\"${fileURL}\")`);\n    const fetchOptions = { method: 'GET' };\n    return fetch(fileURL, fetchOptions)\n      .then(response => {\n        return response.json();\n      })\n      .catch(err => {\n        console.error('fetchJSON fetch err:', err);\n        throw err;\n      });\n  }\n\n  /**\n   * read products from JSON file\n   * @return {Promise<boolean>}\n   */\n  function readProducts () {\n    return fetchJSON(jsonURL)\n      .then(rawData => {\n        products = rawData.groups.reduce(groupsToObject, {});\n        // console.log('readProducts products:', products);\n        return true;\n      })\n      .catch(err => {\n        console.error('readProducts err:', err);\n        return false;\n      })\n  }\n\n  /**\n   * return array of product ids\n   * @return {string[]}\n   */\n  function productIds () {\n    return Object.keys(products);\n  }\n\n  /**\n   * return a single product from store\n   * @param productId\n   * @return {Object}\n   */\n  function getProduct (productId) {\n    return products[productId];\n  }\n\n  /**\n   * return product object to be consumed by Vue\n   * @param productId\n   * @return {{heroHref: *, name: *, id: *}}\n   */\n  function getVueProduct (productId) {\n    const product = products[productId];\n    if (typeof product === 'undefined') {\n      return undefined;\n    }\n    const vueProduct = {\n      id: product.id,\n      name: product.name,\n      heroHref: product.hero.href\n    };\n    if (product.priceRange) {\n      vueProduct.priceRange = product.priceRange;\n    } else if (product.price) {\n      vueProduct.price = product.price;\n    }\n    return vueProduct;\n  }\n\n  return {\n    readProducts,\n    productIds,\n    getProduct,\n    getVueProduct\n  }\n}\n\nexport default WSIProdStore;\n","/**\n * Vue app for displaying products in cards on page\n * @param {string} vmID - id of wrapper DOM element for vue model\n * @return {*}\n */\nfunction WSIProductsVM (vmID) {\n\n  const priceLabel = {\n    regularPrice: 'Regular Price ',\n    salePrice: 'Sale Price ',\n    notOnSale: 'Price ',\n    currencySymbol: '$'\n  };\n\n  Vue.component('product-img', {\n    props: ['product'],\n    template: `\n      <img\n        v-bind:src=\"product.heroHref\"\n        v-bind:data-id=\"product.id\"\n        v-bind:alt=\"product.name\"\n        class=\"card-img-top\"\n        role=\"button\"\n        tabindex=\"0\"\n      >`\n  });\n\n  Vue.component('product-name', {\n    props: ['name'],\n    template: `\n      <p class=\"card-text\" v-html=\"name\"></p>`\n  });\n\n  Vue.component('product-pricing', {\n    props: ['displayprice'],\n    template: `\n      <p class=\"card-text\" v-html=\"displayprice\"></p>`\n  })\n\n  return new Vue({\n    el: `#${vmID}`,\n    data: {\n      products: []\n    },\n\n    methods: {\n\n      addProduct: function (product) {\n        this.products.push(product);\n        return this.products.length;\n      },\n\n      displayPrice: function (product) {\n\n        const [regular, selling] = product.priceRange ?\n          [product.priceRange.regular, product.priceRange.selling] :\n          [product.price.regular, product.price.selling];\n\n        const isOnSale = (reg, sale) => {\n          return (typeof reg === 'number')\n            ? reg !== sale\n            : (reg.low !== sale.low || reg.high !== sale.high);\n        };\n\n        const priceString = (price) => {\n          return (typeof price === 'number')\n            ? `${priceLabel.currencySymbol}${price}`\n            : `${priceLabel.currencySymbol}${price.low} - $${price.high}`;\n        };\n\n        if (isOnSale(regular, selling)) {\n          return (\n            `<span class=\"wsi-price\">${priceLabel.regularPrice}\n            ${priceString(regular)}</span><br/>\n            <span class=\"wsi-price wsi-sale\">${priceLabel.salePrice}\n            ${priceString(selling)}</span>`\n          );\n        } else {\n          return (\n            `<span class=\"wsi-price\">${priceLabel.notOnSale}\n            ${priceString(regular)}</span>`\n          );\n        }\n      }\n    }\n  });\n}\n\nexport default WSIProductsVM;\n\n","// editable css props for carousel modal\n\nconst CSSEditableProps = {\n  fontFamily: '-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,\"Noto Sans\",sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"Noto Color Emoji\"',\n  headerPadding: '0.25rem 1rem',\n  headerParagraphMargin: '0',\n  footerPadding: '0 1rem',\n  thumbnailBtnPadding: '0',\n  thumbnailBtnMargin: '0 4px', /* must be in 'px' units */\n  thumbnailImgHeight: '60px',\n  thumbnailImgHoverFilter: 'brightness(70%) contrast(150%)',\n  thumbnailBorder: 'none',\n  thumbnailSelectedOpacity: '60%',\n  thumbnailSelectedFilter: 'grayscale(100%) brightness(110%) blur(1px)'\n};\n\nexport default CSSEditableProps;\n","// css template for carousel modal\n\nconst CSSTemplate = `\n    /* general */\n    #carousel-modal-container {\n      font-family: {{fontFamily}};\n    }\n\n    /* .cmodal */\n    #carousel-modal-container .cmodal {\n      position: fixed;\n      top: 0;\n      left: 0;\n      z-index: 1050;\n      width: 100%;\n      height: 100%;\n      overflow: hidden;\n      outline: 0;\n      pointer-events: none;\n    }\n    .cmodal-open #carousel-modal-container .cmodal {\n      overflow-x: hidden;\n      overflow-y: auto;\n    }\n    \n    /* .cmodal-dialog */\n    #carousel-modal-container .cmodal .cmodal-dialog {\n      position: relative;\n      width: auto;\n      margin: 0 auto;\n      pointer-events: none;\n      display: flex;\n      align-items: center;\n      min-height: calc(100% - 1rem);\n      opacity: 0;\n      transition: opacity .75s ease;\n    }\n    #carousel-modal-container .cmodal.show .cmodal-dialog {\n     opacity: 1;\n    }\n    @media (max-width: 475px) {\n      #carousel-modal-container .cmodal.show .cmodal-dialog {\n        max-width: 92vw !important;\n      }\n    }\n    \n    /* .cmodal-content */\n    #carousel-modal-container .cmodal-content {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n      pointer-events: auto;\n      background-color: #fff;\n      background-clip: padding-box;\n      border: 1px solid rgba(0,0,0,.2);\n      border-radius: 0.3rem;\n      outline: 0;\n    }\n    \n    /* .cmodal-header */\n    #carousel-modal-container .cmodal-header {\n      display: flex;\n      align-items: flex-start;\n      justify-content: space-between;\n      padding: {{headerPadding}};\n      border-bottom: 1px solid #dee2e6;\n      border-top-left-radius: calc(.3rem - 1px);\n      border-top-right-radius: calc(.3rem - 1px);\n    }\n    #carousel-modal-container .cmodal-header p {\n      margin: {{headerParagraphMargin}};\n    }\n    \n    /* .cmodal-body */\n    #carousel-modal-container .cmodal-body {\n      position: relative;\n      flex: 1 1 auto;\n      padding: 1rem;\n    }\n    \n    /* carousel */\n    #carousel-modal-container .carousel-container {\n      margin: 0;\n      position: relative;\n      width: 100%;\n     }\n     #carousel-modal-container .carousel-overlay-div {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: white;\n      opacity: 0;\n      pointer-events: none;\n      transition: opacity 0.1s;\n     }\n     #carousel-modal-container .carousel-hero {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: auto;\n     }\n     #carousel-modal-container .carousel-overlay {\n       position: absolute;\n       top: 0;\n       left: 0;\n       width: 100%;\n       height: auto;\n     }\n     #carousel-modal-container .carousel-fade-in {\n       opacity: 1;\n       transition: opacity .75s ease;\n     }\n    \n    /* cmodal-footer */\n    #carousel-modal-container .cmodal-footer {\n      display: flex;\n      flex-wrap: wrap;\n      align-items: center;\n      justify-content: flex-end;\n      padding: {{footerPadding}};\n      border-top: 1px solid #dee2e6;\n      border-bottom-right-radius: calc(.3rem - 1px);\n      border-bottom-left-radius: calc(.3rem - 1px);\n    }\n    #carousel-modal-container .div-thumbnails {\n      overflow-x: auto;\n      white-space: nowrap;\n      margin: 0;\n      padding: 8px 16px 12px 16px; /* padding must be 'px' */\n      background-color: transparent;\n      scroll-behavior: smooth;\n    }\n    #carousel-modal-container .div-thumbnails button {\n      padding: {{thumbnailBtnPadding}};\n      margin: {{thumbnailBtnMargin}};\n      background-color: transparent;\n      border: none;\n    }\n    #carousel-modal-container .div-thumbnails button:focus {\n      outline: 2px solid #aaa;\n      outline-offset: 2px;\n    }\n    #carousel-modal-container .div-thumbnails img {\n      height: {{thumbnailImgHeight}};\n      width: auto;\n      margin: 0;\n      border: {{thumbnailBorder}};\n    }\n    #carousel-modal-container .div-thumbnails img:hover {\n      filter: {{thumbnailImgHoverFilter}};\n    }\n    #carousel-modal-container .div-thumbnails img.selected {\n      cursor: default;\n      opacity: {{thumbnailSelectedOpacity}};\n      filter: {{thumbnailSelectedFilter}};\n    }\n    \n    /* close button */\n    #carousel-modal-container button.close {\n      float: right;\n      font-size: 1.5rem;\n      font-weight: 700;\n      line-height: 1;\n      color: #000;\n      text-shadow: 0 1px 0 #fff;\n      padding: 1rem;\n      margin: -1rem -1rem -1rem auto;;\n      background-color: transparent;\n      border: 0;\n      opacity: .5;\n    }\n    #carousel-modal-container button.close:hover {\n      opacity: .8;\n    }\n    \n    /* cmodal-backdrop */\n    .cmodal-backdrop {\n      position: fixed;\n      top: 0;\n      left: 0;\n      z-index: 1040;\n      width: 100vw;\n      height: 100vh;\n      background-color: #000;\n      transition: opacity .3s ease;\n      opacity: 0;\n    }\n    .cmodal-backdrop.show {\n      opacity: 0.5;\n    }\n    \n    /* .cmodal-open */ \n    .cmodal-open {\n      overflow: hidden;\n    }\n    \n    cmodal-open cmodal {\n      overflow-x: hidden;\n      overflow-y: auto;\n    }\n`;\n\nexport default CSSTemplate;\n","// HTML template for carousel modal - a Bootstrap modal with an image carousel\n\nconst HTMLTemplate = `\n  <div\n    tabindex=\"-1\"\n    class=\"cmodal\"\n    data-wrap=\"false\"\n    style=\"display: none\"\n  >\n    <div\n      class=\"cmodal-dialog cmodal-dialog-centered\"\n      style=\"max-width: calc(-2rem + 58vh)\"\n    >\n      <div class=\"cmodal-content\">\n      \n        <div class=\"cmodal-header\">\n          <p><!-- name of product --></p>\n          <button type=\"button\"\n            aria-label=\"Close\"\n            class=\"close\"\n          >\n            <span aria-hidden=\"true\">Ã—</span>\n          </button>\n        </div> <!-- /.cmodal-header -->\n        \n        <div class=\"cmodal-body\">\n          <div\n            class=\"carousel-container\"\n            data-aspect-ratio=\"0.6666667\"\n            style=\"padding-bottom: 150%\"\n          >\n            <img\n              class=\"carousel-hero\"\n              src=\"\"\n              alt=\"carousel hero\">\n            <!-- .carousel-overlay-div -->\n            <div\n              class=\"carousel-overlay-div\"\n            >\n              <img\n                class=\"carousel-overlay\"\n                alt=\"carousel overlay\"\n                src=\"\"\n              >\n            </div> <!-- /.carousel-overlay-div -->\n          </div> <!-- /.carousel-container -->\n        </div> <!-- /.cmodal-body -->\n\n        <div class=\"cmodal-footer\">\n          <div class=\"div-thumbnails\"></div>\n        </div> <!-- /.cmodal-footer -->\n        \n      </div> <!-- /.cmodal-content -->\n    </div> <!-- /.cmodal-dialog -->\n  </div> <!-- /.cmodal -->\n  <div class=\"cmodal-backdrop\" style=\"display: none\"></div>\n`;\n\nexport default HTMLTemplate;\n","// image gallery carousel overlay with thumbnails\n\nimport CSSTemplate from './CSSTemplate.js';\nimport CSSEditableProps from './CSSEditableProps.js';\nimport HTMLTemplate from './HTMLTemplate.js';\n\nfunction OverlayCarousel (userEditsToCSSProps) {\n\n  // work on duplicates of the templates\n  const editableCSSProps = { ...CSSEditableProps };\n  let cssContent = CSSTemplate.slice(0);\n\n  // handy reference to our created HTML elements\n  // set with _htmlElementReferences()\n  const htmlRefs = {};\n\n  let _modalIsShowing = false;\n\n  // state of the div + image that overlays the hero image\n  // to perform cross-fading\n  function _initOverlayState () {\n    return {\n      inTransition: false,\n      imgSrc: \"\",\n      imgAlt: \"\",\n      imgTitle: \"\",\n      imgIndex: null,\n      timeoutID: null\n    };\n  }\n  const _overlayState = _initOverlayState();\n\n  // state of the thumbnails\n  function _initThumbnailsState () {\n    return {\n      imgs: [],\n      firstThumbnailImg: null,\n      firstThumbnailBtn: null,\n      lastThumbnailImg: null,\n      lastTumbnailBtn: null,\n      selectedThumbnailImg: null\n    };\n  }\n  const _thumbnailsState = _initThumbnailsState();\n\n  // true if element (and browser) support smooth scrolling\n  const _hasSmoothScrolling = (el) => {\n    return getComputedStyle(el).scrollBehavior === 'smooth';\n  }\n\n  // apply user edits to editable css props\n  function _applyUserEditsToCSSProps (edits) {\n    if (typeof edits === 'undefined') { return; }\n    for (const [propName, value] of Object.entries(edits)) {\n      if (typeof editableCSSProps[propName] === 'undefined') { continue; }\n      editableCSSProps[propName] = value;\n    }\n  }\n\n  // apply all css props to cssContent\n  function _applyCSSPropsToCSSContent (props) {\n    for (const [propName, value] of Object.entries(props)) {\n      const searchStr = `{{${propName}}}`;\n      const subStr = `${value}`;\n      cssContent = cssContent.replace(searchStr, subStr);\n    }\n  }\n\n  // create style sheet HTML element with `textContent`\n  function _createStyleSheetElement (textContent) {\n    const style = document.createElement('style');\n    style.textContent = textContent;\n    return style;\n  }\n\n  // create carousel-modal-container div\n  function _createCarouselModalContainer (innerHTML) {\n    const div = document.createElement('div');\n    div.id = \"carousel-modal-container\";\n    div.innerHTML = innerHTML;\n    return div;\n  }\n\n  // references to our significant HTML elements\n  function _htmlElementReferences (galleryOverlay) {\n    const\n      shadowRoot = galleryOverlay.shadowRoot,\n      cModalContainer =  shadowRoot.getElementById(\n      'carousel-modal-container'),\n      cModal = cModalContainer.querySelector('.cmodal'),\n      cmBackdrop = cModalContainer.querySelector('.cmodal-backdrop'),\n      cmDialog = cModal.querySelector('.cmodal-dialog'),\n      cmContent = cmDialog.querySelector('.cmodal-content'),\n      cmHeader = cmDialog.querySelector('.cmodal-header'),\n      cmHeaderP = cmHeader.querySelector('p'),\n      closeBtn = cmHeader.querySelector('button.close'),\n      cmBody = cmDialog.querySelector('.cmodal-body'),\n      carouselContainer = cmBody.querySelector('.carousel-container'),\n      heroImg = carouselContainer.querySelector('.carousel-hero'),\n      overlayDiv = carouselContainer.querySelector('.carousel-overlay-div'),\n      overlayImg = overlayDiv.querySelector('.carousel-overlay'),\n      cmFooter = cmDialog.querySelector('.cmodal-footer'),\n      thumbnailsDiv = cmFooter.querySelector('.div-thumbnails');\n\n    return{\n      shadowRoot, cModalContainer, cModal, cmBackdrop, cmDialog, cmContent,\n      cmHeader, cmHeaderP, closeBtn, cmBody, carouselContainer, heroImg,\n      overlayDiv, overlayImg, cmFooter, thumbnailsDiv\n    };\n  }\n\n  // <gallery-overlay> custom element\n  class GalleryOverlay extends HTMLElement {\n    constructor() {\n      super();\n\n      // append shadow root\n      this.attachShadow({mode: 'open'});\n\n      // append style element to the shadow DOM\n      this.shadowRoot.append(_createStyleSheetElement(cssContent));\n\n      // append carousel modal container and its contents to shadow DOM\n      this.shadowRoot.append(_createCarouselModalContainer(HTMLTemplate));\n    }\n  }\n  \n  function _createGalleryOverlay () {\n    // console.log('_createGalleryOverlay()');\n    customElements.define('gallery-overlay', GalleryOverlay);\n    return document.createElement('gallery-overlay');\n  }\n\n  function _appendGalleryOverlayToBody (galleryOverlay) {\n    document.body.appendChild(galleryOverlay);\n  }\n\n  /**\n   * select thumbnail and display as hero image\n   * @param {HTMLImageElement} thumbnailImg\n   * @param {boolean} animate - animate the hero image transition\n   */\n  function _selectAndDisplayImage (\n    thumbnailImg,\n    animate = true)\n  {\n    // console.log(`_selectAndDisplayImage()`);\n\n    // deselect current thumbnail and select new one\n    if(_thumbnailsState.selectedThumbnailImg) {\n      _thumbnailsState.selectedThumbnailImg.classList\n        .remove('selected');\n    }\n    _thumbnailsState.selectedThumbnailImg = thumbnailImg;\n    thumbnailImg.classList.add('selected');\n\n    // scroll to the selected thumbnail\n    _scrollThumbnailsViewport();\n\n    // clear existing overlay timeout, if one exists\n    if (_overlayState.timeoutID !== null) {\n      // console.log('    clearing prior timeout');\n      clearTimeout(_overlayState.timeoutID);\n      _overlayState.timeoutID = null;\n    }\n\n    // set overlay state for the selected image\n    Object.assign(_overlayState, {\n      imgSrc: thumbnailImg.src,\n      imgAlt: thumbnailImg.alt,\n      imgTitle: thumbnailImg.title,\n      imgIndex: Number(thumbnailImg.dataset.index)\n    });\n\n    // change the fade-in overlay image\n    htmlRefs.overlayImg.src = _overlayState.imgSrc;\n\n    if (animate === false) {\n      // clean up without animation\n      _completeImageFade();\n      return;\n    }\n\n    // with animation: fade in overlay image\n    // console.log('_selectAndDisplayImage fading in overlay');\n    _overlayState.inTransition = true;\n    htmlRefs.overlayDiv.classList.add('carousel-fade-in');\n\n    // add timeout in case 'transitionend' event is never received\n    const thisIndex = _overlayState.imgIndex;\n    _overlayState.timeoutID = setTimeout(() => {\n      if (_overlayState.inTransition === false) { return; }\n      if (_overlayState.imgIndex !== thisIndex) { return; }\n      // console.log(`transitionend timeout for index ${thisIndex}, call _completeImageFade()`);\n      _completeImageFade();\n    }, 1500);\n  }\n\n  // clean up display elements after image fade transition completes\n  function _completeImageFade () {\n    // console.log('_completeImageFade() _overlayState.inTransition:', _overlayState.inTransition);\n\n    _overlayState.inTransition = false;\n\n    // update hero image\n    if (_overlayState.imgSrc && _overlayState.imgSrc.length > 0) {\n      Object.assign(htmlRefs.heroImg, {\n        src: _overlayState.imgSrc,\n        alt: _overlayState.imgAlt,\n        title: _overlayState.imgTitle\n      });\n    }\n\n    // reset overlay state\n    Object.assign(_overlayState, _initOverlayState());\n\n    // clean up overlay\n    if (_overlayState.inTransition) { return; }\n    htmlRefs.overlayDiv.classList.remove('carousel-fade-in');\n  }\n\n  // upon enter keydown over thumbnail button, dispatch click on thumbnail image\n  function _listenForEnterKeyOverButton () {\n    const  handleEnterKey = (e) => {\n      if (e.key !== 'Enter') { return; }\n      const elem = e.target;\n      if (elem.tagName !== 'BUTTON') { return; }\n      const btnImg = elem.firstChild;\n      if (!btnImg || btnImg.tagName !== 'IMG') { return; }\n      btnImg.click();\n    };\n    htmlRefs.thumbnailsDiv.addEventListener('keydown', handleEnterKey);\n  }\n\n  // respond to clicks on thumbnail images\n  function _listenForThumbnailImageClicks () {\n    const handleClick = (evt) => {\n      const elClicked = evt.target;\n      const isThumbnailImg = (el) => el.tagName === 'IMG'\n        && typeof el.dataset.index !== 'undefined';\n      if (isThumbnailImg(elClicked) === false) { return; }\n      _selectAndDisplayImage(elClicked);\n    };\n    htmlRefs.thumbnailsDiv.addEventListener('click', handleClick);\n  }\n\n  // listen for overlay fade completion\n  function _listenForImageOverlayFade () {\n    htmlRefs.overlayDiv.addEventListener('transitionend',\n      _completeImageFade);\n  }\n\n  // listen for tab key to keep focus on gallery overlay elements\n  function _handleTab (evt) {\n    if (evt.key !== 'Tab') { return; }\n    const isShiftTab = evt.shiftKey === true;\n    const elWithFocus = htmlRefs.shadowRoot.activeElement;\n    const lastThumbnailHasFocus =\n      elWithFocus === _thumbnailsState.lastThumbnailBtn;\n    const tabbingFromLastThumbnail = lastThumbnailHasFocus && !isShiftTab;\n    const closeBtnHasFocus = elWithFocus === htmlRefs.closeBtn;\n    const shiftTabbingFromCloseBtn = closeBtnHasFocus && isShiftTab;\n\n    // handle tab and shift-tab from any non-gallery element\n    if (elWithFocus === null) {\n      evt.preventDefault();\n      if (isShiftTab) {\n        _thumbnailsState.lastThumbnailBtn.focus();\n      } else {\n        htmlRefs.closeBtn.focus();\n      }\n      return;\n    }\n\n    // blur when tabbing off the ends of tabbable element list\n    if (tabbingFromLastThumbnail || shiftTabbingFromCloseBtn) {\n      evt.preventDefault();\n      elWithFocus.blur();\n    }\n  }\n  function _listenForTabKey () {\n    document.addEventListener('keydown', _handleTab);\n  }\n  function _removeTabKeyListener () {\n    document.removeEventListener('keydown', _handleTab);\n  }\n\n  // hide everything\n  function _hideModal () {\n    // console.log('_hideModal()');\n\n    if (_modalIsShowing === false) { return; }\n    _modalIsShowing = false;\n\n    _removeTabKeyListener();\n\n    htmlRefs.cmBackdrop.addEventListener('transitionend', () => {\n        htmlRefs.cmBackdrop.style.display = 'none';\n      }, { once: true }\n    );\n    htmlRefs.cModal.addEventListener('transitionend', () => {\n        htmlRefs.cModal.style.display = 'none';\n      }, { once: true }\n    );\n\n    htmlRefs.cmBackdrop.classList.remove('show');\n    htmlRefs.cModal.classList.remove('show');\n    document.body.classList.remove('cmodal-open');\n  }\n\n  // respond to events intended to hide modal\n  function _listenForHideModalEvents () {\n\n    // a click on modal close button\n    htmlRefs.closeBtn.addEventListener('click', _hideModal);\n\n    // a click on modal backdrop\n    htmlRefs.cmBackdrop.addEventListener('click', _hideModal);\n\n    // ESC key pressed anywhere\n    document.addEventListener('keyup', evt => {\n      if (evt.key === 'Escape') {\n        // console.log('ESC key pressed');\n        _hideModal();\n      }\n    });\n  }\n\n  // scroll viewport using vanilla JavaScript\n  // (for browsers like Safari that don't natively support smooth scrolling)\n  function _vpScrollJavaScript (scrollDest) {\n    // simulate scroll feature with vanilla JavaScript\n    const timeStep = 20;\n    const timeTotal = 400;\n    const stepsTotal = Math.round(timeTotal/timeStep);\n    const scrollStart = htmlRefs.thumbnailsDiv.scrollLeft;\n    const scrollTotal = scrollDest - scrollStart;\n    const scrollStep = Math.round(scrollTotal/stepsTotal);\n    let time = timeStep,\n      scroll = scrollStart + scrollStep;\n\n    const _scrollRecursive = () => {\n      if (time >= timeTotal) {\n        htmlRefs.thumbnailsDiv.scrollLeft = scrollDest;\n        return;\n      }\n      htmlRefs.thumbnailsDiv.scrollLeft = scroll;\n      time += timeStep;\n      scroll += scrollStep;\n      setTimeout(_scrollRecursive, timeStep);\n    }\n\n    if (scrollTotal === 0) { return; }\n\n    _scrollRecursive();\n  }\n\n  /**\n   * scroll thumbnails viewport to show currently selected thumbnail\n   * in center\n   */\n  function _scrollThumbnailsViewport () {\n    const thumbnailImg = _thumbnailsState.selectedThumbnailImg;\n    if (!thumbnailImg) { return; }\n    const vpScrollWidth = htmlRefs.thumbnailsDiv.scrollWidth;\n    const vpStyle = getComputedStyle(htmlRefs.thumbnailsDiv);\n    const vpPaddingLeft = parseFloat(vpStyle.paddingLeft);\n    const vpWindowWidth = htmlRefs.thumbnailsDiv.clientWidth;\n    const vpScrollMax = vpScrollWidth - vpWindowWidth;\n    const tnButton = thumbnailImg.parentElement;\n    const tnButtonStyle = getComputedStyle(tnButton);\n    const tnButtonWidth = tnButton.offsetWidth\n      + parseFloat(tnButtonStyle.marginLeft)\n      + parseFloat(tnButtonStyle.marginRight);\n    const tnOffsetCenter = tnButton.offsetLeft\n      + (tnButton.offsetWidth / 2);\n\n    // scroll to position thumbnail in center of viewport window\n    let newScrollLeft = tnOffsetCenter\n      - Math.round((vpWindowWidth + tnButtonWidth) / 2)\n      + vpPaddingLeft;\n    if (newScrollLeft < 0) { newScrollLeft = 0; }\n    if (newScrollLeft > vpScrollMax) { newScrollLeft = vpScrollMax; }\n\n    if (_hasSmoothScrolling(htmlRefs.thumbnailsDiv)) {\n      // console.log('scrolling with Element.scrollLeft = newScrollLeft');\n      htmlRefs.thumbnailsDiv.scrollLeft = newScrollLeft;\n    } else {\n      _vpScrollJavaScript(newScrollLeft);\n    }\n\n    // give focus to the thumbnail button\n    tnButton.focus();\n  }\n\n  function _populateThumbnails (hrefs, titles, imgOnLoadHandler) {\n    htmlRefs.thumbnailsDiv.innerHTML = '';\n    Object.assign(_thumbnailsState, _initThumbnailsState());\n    _thumbnailsState.imgs = hrefs.map((href, index) => {\n      const btnThumb = document.createElement('button');\n      htmlRefs.thumbnailsDiv.appendChild(btnThumb);\n\n      const imgThumb = document.createElement('img');\n      imgThumb.onload = imgOnLoadHandler;\n      imgThumb.dataset.index = String(index);\n      imgThumb.src = href;\n      if (titles !== null) {\n        imgThumb.alt = imgThumb.title = titles[index];\n      }\n      btnThumb.appendChild(imgThumb);\n\n      return imgThumb;\n    });\n    _thumbnailsState.firstThumbnailImg = _thumbnailsState.imgs[0];\n    _thumbnailsState.firstThumbnailBtn =\n      _thumbnailsState.firstThumbnailImg.parentElement;\n    _thumbnailsState.lastThumbnailImg =\n      _thumbnailsState.imgs[_thumbnailsState.imgs.length - 1];\n    _thumbnailsState.lastThumbnailBtn =\n      _thumbnailsState.lastThumbnailImg.parentElement;\n\n    // display thumbnails only when there are multiple images\n    const hasMultipleImages = hrefs.length > 1;\n    htmlRefs.cmFooter.style.display = hasMultipleImages ? '' : 'none';\n  }\n\n  /**\n   * populate overlay with name, hero and thumbnail images\n   * @param name\n   * @param hrefs\n   * @param titles\n   * @return {Promise<unknown>}\n   */\n  function populate (name, hrefs, titles = null) {\n    // console.log(`populate()`);\n    const hrefsCount = hrefs.length;\n    let completed = false;\n\n    return new Promise(function (resolve, reject) {\n\n      // display the modal (invisibly) to obtain its dimensions\n      const displaySave = htmlRefs.cModal.style.display;\n      htmlRefs.cModal.style.display = 'block';\n\n      htmlRefs.cmHeaderP.innerHTML = name;\n\n      let imagesLoaded = 0;\n      let aspectRatioMin = Infinity;\n\n      // detect image aspect ratio when it receives a 'load' event\n      function _evalLoadedImage () {\n        const img = this;\n        const imgAspectRatio = (img.height > 0) ? img.width / img.height : null;\n\n        imagesLoaded++;\n        if (imgAspectRatio === null) { return; }\n\n        img.dataset.aspectRatio = String(imgAspectRatio);\n        aspectRatioMin = (imgAspectRatio < aspectRatioMin) ?\n          imgAspectRatio : aspectRatioMin;\n\n        if (imagesLoaded < hrefsCount) { return; }\n        if (aspectRatioMin === Infinity) { return; }\n\n        // all images loaded:\n\n        // set padding-bottom of container to accommodate tallest image\n        htmlRefs.carouselContainer.style.paddingBottom =\n          Math.round(1.0 / aspectRatioMin * 100) + '%';\n        htmlRefs.carouselContainer.dataset.aspectRatio = String(aspectRatioMin);\n\n        // set the modal's max width to maintain its aspect ratio\n        // while keeping the entire modal within the browser's viewport\n        const modalAspectRatio =\n          htmlRefs.cmContent.offsetWidth / htmlRefs.cmContent.offsetHeight;\n        htmlRefs.cmDialog.style.maxWidth =\n          `calc(-30px + ${\n            Math.round(modalAspectRatio * 100)\n          }vh)`;\n\n        // restore the modal's display state\n        htmlRefs.cModal.style.display = displaySave;\n\n        // all images loaded, mark as completed and resolve the promise\n        completed = true;\n        resolve();\n      }\n\n      // populate the thumbnails\n      _populateThumbnails(hrefs, titles, _evalLoadedImage);\n\n      // set a timeout in case some images don't load\n      setTimeout(() => {\n        if (completed) { return; }\n        // reject with an error message\n        const errmsg = `unable to load some images, expected ${hrefsCount}` +\n          `, loaded ${imagesLoaded}`;\n        reject(errmsg);\n      }, 2000);\n\n    });\n  }\n\n  // show the image gallery\n  function show () {\n\n    // console.log('show()');\n\n    if (_modalIsShowing) { return; }\n\n    // make the display changes *before* showing the modal\n    if (_thumbnailsState.firstThumbnailImg === null) {\n      console.error('no thumbnail images found');\n      return;\n    }\n    _selectAndDisplayImage(_thumbnailsState.firstThumbnailImg, false);\n\n    htmlRefs.cmBackdrop.style.display = 'block';\n    htmlRefs.cModal.style.display = 'block';\n\n    // listen for tab keys\n    _listenForTabKey();\n\n    // delay showing slightly to avoid any UI flash\n    setTimeout(() => {\n      htmlRefs.cModal.classList.add('show');\n      htmlRefs.cmBackdrop.classList.add('show');\n      document.body.classList.add('cmodal-open');\n      _modalIsShowing = true;\n    }, 200);\n  }\n\n\n  function _init () {\n    _applyUserEditsToCSSProps(userEditsToCSSProps);\n    _applyCSSPropsToCSSContent(editableCSSProps);\n    const galleryOverlay = _createGalleryOverlay();\n    _appendGalleryOverlayToBody(galleryOverlay);\n    Object.assign(htmlRefs, _htmlElementReferences(galleryOverlay));\n\n    _listenForImageOverlayFade();\n    _listenForThumbnailImageClicks();\n    _listenForEnterKeyOverButton();\n    _listenForHideModalEvents();\n  }\n\n  // initialize\n  _init();\n\n  return {\n    populate,\n    show\n  };\n\n}\n\nexport default OverlayCarousel;\n"],"sourceRoot":""}